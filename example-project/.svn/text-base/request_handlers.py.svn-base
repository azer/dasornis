from dasornis.core import HttpHandler
import queries

class Homepage(HttpHandler):
  def get(self):
    self.response.write("<h1>Fruit Manager</h1>")
    self.response.write("""
      <ul>
        <li><a href="/list">List Fruits</a></li>
        <li><a href="/add">Add Fruit</a></li>
        <li><a href='404'>404 page</a></li>
      </ul>
    """)

class ListPage(HttpHandler):
  def get(self):
    fruits = queries.GetFruits()
    fruits_html = '<br />'.join([ fruit[1] for fruit in fruits ])
    self.template = ('templates/list.html','pythonstring')
    self.template.args.append( ('fruits',fruits_html)  )

class AddPage(HttpHandler):
  def get(self):
    self.template = 'templates/add.html'
    
  def post(self):
    queries.CreateFruit(self.request.POST['fruit'])
    self.redirect('/list')
